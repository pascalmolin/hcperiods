\documentclass[main.tex]{subfiles}

\begin{document}

  \section{Computing the Abel-Jacobi map}\label{sec:comp_ajm}
  
   Here we are concerned with explicitly computing the Abel-Jacobi map of degree zero divisors; for a general introduction see Section \ref{m-sec:ajm}.
   
   Assume for this section that we already computed a big period period matrix (and all related data) following the Strategy from Section \ref{m-sec:strat_pm}. 
   
   Let $D = \sum_{P \in \cu} v_P P \in \Div^0(\cu)$. After choosing a basepoint $P_0 \in \cu$, the computation of $\AJ$ reduces (using linearity) to
   \begin{equation*}
     \AJ([D]) \equiv \sum_{P \in \cu} v_P \int_{P_0}^P \bar\w \mod \Lambda.
   \end{equation*}
  For every $P \in \cu$, $\int_{P_0}^P \bar\w$ is a linear combination of vector integrals of the form
  \begin{align*}
    \int_{P_0}^{P_k} \bar\w\quad \text{(see \S \ref{m-subsec:ajm_ram_pts}),} \quad
    \int_{P_k}^{P} \bar\w \quad \text{(see \S \ref{m-subsec:ajm_finite})}
    \quad \text{and} \quad \int_{P_0}^{P_{\infty}} \bar\w\quad \text{(see \S \ref{m-subsec:ajm_infty}),} \quad \text{where}
  \end{align*}
  \begin{itemize}
   \item $\bar\w$ is the vector of differentials in $\W$,
   \item $P = (x_P,y_P) \in \cu$ is a finite point on the curve,
   \item $P_k = (x_k,0) \in \cu$ is a ramification point, i.e.\ $x_k \in X$, and
   \item $P_{\infty} \in \cu$ is an infinite point.
  \end{itemize}
  
   Typically, we choose as basepoint the ramification point $P_0 = (x_0,0)$, where $x_0 \in X$ is the root of the spanning tree $T = (X,E)$.
   
  Finally, the resulting vector integral has to be reduced modulo the period lattice $\Lambda$, which is covered in \S \ref{m-subsec:lat_red}. For practical reasons, we will compute the
  image of the Abel-Jacobi map in the torus $\R^{2g} / \Z^{2g}$.
  
  
  \subsection{Between ramification points}\label{subsec:ajm_ram_pts}

  Suppose we want to integrate $\bar\w$ from $P_0 =(x_0,0)$ to $P_k = (x_k,0)$. By construction there exists a path
 $(x_0=x_{k_0},x_{k_1},\dots,x_{k_{n-1}},x_{k_t}=x_k)$ in the spanning tree which connects $x_0$ and $x_k$. Thus, the integral splits into
  \begin{align*}
    \int_{P_0}^{P_k} \bar\w = \sum_{j = 0}^{t-1}  \int_{P_{k_j}}^{P_{k_{j+1}}} \bar\w.
  \end{align*}
  Denote $a = x_{k_j}, b = x_{k_{j+1}} \in X$. From \S \ref{m-subsec:cycles_homo} we know that for $(a,b) \in E$ a smooth path between $P_a=(a,0)$ and $P_b=(b,0)$ is given by
  \begin{align*}
   \gamma_{[a,b]}^{(0)} = \{  (x,\yab(x))  \mid  x \in [a,b]  \}.
  \end{align*}
  Let $\w_{i,j} \in \W$ be a differential. According to the proof of Theorem \ref{m-thm:periods} the corresponding integral is given by
  \begin{align*}
   \int_{\gamma_{[a,b]}^{(0)}} \w_{i,j}  & = 
   (1-\zeta^{-j}) C_{a,b}^{-j} \left(\frac{b-a}{2}\right)^i \int_{-1}^1 \frac{\varphi_{i,j}(u)}{(1-u^2)^{\frac{j}{m}}}  \du,
  \end{align*}
  which is  (up to the constants) an elementary integral and has already been evaluated during the period matrix computation.
  
  Moreover, the image of the Abel-Jacobi map between ramification points is $m$-torsion, i.e. for any two $k,j \in \{1,\dots,n\}$ we have
  \begin{equation}\label{eq:m_tors}
    m \int_{P_j}^{P_k} \bar\w \equiv \AJ( [ mP_k - mP_j ] ) \equiv 0 \mod  \Lambda,
  \end{equation}
  since $\div\left( \frac{x-x_k}{x-x_j} \right) = mP_k - mP_j$ is a principal divisor.

  \subsection{Reaching non-ramification points}\label{subsec:ajm_finite}

  Let $P = (x_P,y_P) \in \cu$ be a finite point and $P_a = (a,0)$ a ramification point such that $X\cap]a,x_P]=\varnothing$. In order to define a smooth path between $P$ and $P_a$ 
  we need to find a suitable analytic branch of $\cu$. 
  
  This can be done (almost analogously) following  the approach from \S \ref{m-subsubsec:analytic_branches}, the only difference being that
  $x_P$ is not a branch point. Therefore, we are going to adjust the definitions and highlight the differences.
  
  Let  $\uaxp$ be the affine linear transformation
  that maps $[-1,1]$ to $[a,x_P]$. Similar to \eqref{m-eq:uab_preimage} we split up the preimage of $X$ under $\uaxp$ into subsets, but this time
 \begin{equation*}
  \uaxp^{-1}(X) = \{-1\} \cup U^+ \cup U^-.
 \end{equation*}
  Then, $\ytaxp(u)$ can be defined exactly as in $\eqref{m-eq:ytab}$ and
  is holomorphic in a neighbourhood $\epsilon_{a,x_P}$ of $[-1,1]$.
  The term corresponding to $a$, that is
  \begin{equation*}
   \sqrt[m]{1+u},
  \end{equation*}
   has a branch cut $]-\infty,-1]$ and is holomorphic on the complement of this cut.
   
  Now we can define a branch of the curve,
   that is analytic in a neighbourhood $V_{a,x_P}$ of $]a,x_P]$, by
  \begin{equation*}
    \yaxp(x) =   C_{a,x_P} \ytaxp( \uaxp^{-1}(x) ) \sqrt[m]{1 + \uaxp^{-1}(x)}
  \end{equation*}
  where 
   \begin{equation*}
      C_{a,x_P} = \left(\frac{x_P-a}{2}\right)^{\frac{n}{m}} e^{\frac{\pi i}{m}(\#U^+ \bmod 2)}.
  \end{equation*}
  
  More concretely: The statements of Proposition \ref{m-prop:yab} continue to hold for $\ytaxp$ and $\yaxp$, 
  if we choose the sets $\epsilon_{a,x_P}$ and $V_{a,x_P}$ as if $x_P$ was a branch point.
  
  Therefore, the lifts of $[a,x_P]$ to $\cu$ are given by
    \begin{equation}\label{eq:def_path_axp}
      \gamma^{(l)}_{[a,x_P]} = \{  (x,\zeta^l \yaxp(x))  \mid  x \in [a,x_P]  \}, \quad l \in \Z/m\Z.
   \end{equation}
  In order to reach $P = (x_P,y_P)$ we have to pick the correct lift. This is done by computing the \emph{shifting function} $s(x) \in \Z/m\Z$ at the endpoint $x_P$:
  \begin{align*}
   \zeta^{s(x_P)} & = \frac{y_P}{\yaxp(x_P)} = \frac{y_P}{ C_{a,x_P} \ytaxp( \uaxp^{-1}(x_P) ) \sqrt[m]{2}  } \\
   \Rightarrow s = s(x_P) & = \frac{m}{2\pi} \arg\left(  \frac{y_P}{C_{a,x_P} \ytaxp( \uaxp^{-1}(x_P) )} \right)
  \end{align*}
  Consequently, $\gamma^{(s)}_{[a,x_P]}$ is a smooth path between $P_a$ and $P$ on $\cu$. We can now state the main theorem of this section.
  
  \begin{thm}\label{thm:ajm_finite_int}
  Let $\w_{i,j} \in \WM$ be a differential. With the choices and notation as above we have
 \begin{equation}\label{eq:aj_int}
       \int_{P_a}^P \w_{i,j} = \zeta^{-sj} C_{a,x_P}^{-j} \left(\frac{x_P-a}{2}\right)^i \int_{-1}^1 \frac{\varphi_{i,j}(u)}{(1+u)^{\frac{j}{m}}}  \du,
  \end{equation}
   where
   \begin{equation*}
    \varphi_{i,j}  = \left(u+\frac{x_P+a}{x_P-a}\right)^{i-1} \ytaxp(u)^{-j}
   \end{equation*}
   is holomorphic in a neighbourhood $\epsilon_{a,x_P}$ of $[-1,1]$.
  \end{thm}
  \begin{proof}
    We have
    \begin{align*}
     \int_{P_a}^P \w_{i,j}  & =  \int_{\gamma^{(s)}_{[a,x_P]}} \frac{x^{i-1}}{y^j}  \dx  =  \zeta^{-sj} \int_a^{x_P} \frac{x^{i-1}}{\yaxp(x)^j}  \dx \\  & = 
     \zeta^{-sj} C_{a,x_P}^{-j}  \int_a^{x_P} \frac{x^{i-1}}{(1+\uaxp^{-1}(x))^{\frac{j}{m}}\ytaxp(\uaxp^{-1}(x))^j}  \dx
  \end{align*}
   Applying the transformation $x \mapsto \uaxp(u)$ introduces the derivative $\dx = \left(\frac{x_P-a}{2}\right) \du$.
  \begin{align*}
   & =  \zeta^{-sj} C_{a,x_P}^{-j} \left(\frac{x_P-a}{2}\right) \int_a^{x_P} \frac{\uaxp(u)^{i-1}}{(1+u)^{\frac{j}{m}}\ytaxp(u)^j}  \du \\ & =
   \zeta^{-sj} C_{a,x_P}^{-j} \left(\frac{x_P-a}{2}\right)^i \int_a^{x_P} \frac{\left(u + \frac{x_P+a}{x_P-a}\right)^{i-1}}{(1+u)^{\frac{j}{m}}\ytaxp(u)^j}  \du.
  \end{align*}
  The statement about holomorphicity of $\varphi_{i,j}$ is implied, since Proposition \ref{m-prop:yab} holds for $\ytaxp$ and $\yaxp$ as discussed above.
  \end{proof}

  \begin{rmk}\label{rmk:ajm_finite_int}
   By Theorem \ref{m-thm:ajm_finite_int}, the problem of integrating $\bar\w$ from $P_0$ to $P$ reduces to numerical integration of
    \begin{equation*}
       \int_{-1}^1 \frac{\varphi_{i,j}(u)}{(1+u)^{\frac{j}{m}}}  \du.
   \end{equation*}
   Since these integrals are very similar to the elementary integrals \eqref{m-eq:elem_ints} that occur during the period matrix computation, they can be computed with a little twist to
   the methods presented in Section \ref{m-sec:numerical_integration}.
   \end{rmk}

  
  
  \subsection{Infinite points}\label{subsec:ajm_infty}

  Recall from \S \ref{m-subsec:se_def} that there are $\delta = \gcd(m,n)$ infinite points on our projective curve $\cu$, so
  we introduce the set $\mathcal{P}
  = \{ P_{\infty}^{(1)},\dots, P_{\infty}^{(\delta)} \}$.
  
  
  Suppose we want to integrate from $P_0$ to $P_{\infty} \in \mathcal{P}$, which is equivalent to computing the Abel-Jacobi map of the divisor
  $D_{\infty} = P_{\infty} - P_0$.

  Our strategy is to explicitly apply Chow's moving lemma to $D_{\infty}$: we construct a principal divisor $D \in \Prin(\cu)$ such that $\supp(D) \cap \mathcal{P} = \{ P_{\infty} \}$
  and $\ord_{P_{\infty}}(D) = \pm 1$. Then, by definition of the Abel-Jacobi map,
  \begin{equation*}
  \AJ([D_{\infty} \mp D]) \equiv \AJ([D_{\infty}]) \equiv \int_{P_0}^{P_{\infty}} \bar\w \mod \Lambda
  \end{equation*}
  and $\supp(D_{\infty} \mp D) \cap \mathcal{P} = \varnothing$.
  
  The exposition in this paragraph will explain the construction of $D$, while distinguishing three different cases.
  
  In the following denote by  $-\mu,\nu > 0$ the coefficients of the BÃ©zout identity
  \begin{equation*}
    \mu m + \nu n = \delta.
  \end{equation*}
  
  \begin{rmk}
   Note that there are other ways of computing $\AJ([D_{\infty}])$. For instance, using transformations or direct numerical
   integration. Especially in the case $\delta = m$ a transformation (see \ref{m-rmk:moebius}) is the better option and may be used in practice.
   The advantage of this approach is that we can stay in our setup, i.e. we can compute solely on $\caff$ and
   keep the integration scheme.
  \end{rmk}

  
  
  \subsubsection{Coprime degrees}\label{subsec:ajm_inf_cop}
  
  For $\delta = 1$ there is only one infinite point $\mathcal{P} = \{ P_{\infty} \}$ and
  we can easily compute  $\AJ( [D_{\infty}] )$ by adding a suitable
  principal divisor $D$
    \begin{align*}
      &\div(y^{\nu})=  \nu \sum_{k = 1}^n P_k - \nu n P_{\infty},\\
      &\div((x-x_0)^{\mu})  =  \mu m P_0 - \mu m P_{\infty} ,\\
      D  =  & \div(y^{\nu}(x-x_0)^{\mu})  = \nu \sum_{k = 1}^n P_k + \mu m P_0 - P_{\infty}.
    \end{align*}
    We immediately obtain
    \begin{align*}
     \AJ( [D_{\infty}] )  & \equiv  \AJ([D_{\infty} + D])  =  \AJ( [ \nu \sum_{k = 1}^n P_k + (\mu m - 1) P_0 ]  ) \\ & 
      \equiv   \nu \sum_{k=1}^n \int_{P_0}^{P_k} \bar\w \mod \Lambda
    \end{align*}
    and conclude that $\AJ( [D_{\infty}] )$ can be expressed in terms of integrals between
    ramification points (see \S \ref{m-subsec:ajm_ram_pts}).
  \begin{rmk}\label{rmk:sum_infty_pts}
  In general, the principal divisor
  \begin{equation*}
    D  = \div(y^{\nu}(x-x_0)^{\mu}) = \nu \sum_{k = 1}^n P_k + \mu m P_0 - \sum_{l = 1}^{\delta} P^{(l)}_{\infty}
  \end{equation*}
  yields the useful relation
  \begin{equation*}
  \nu \sum_{k=1}^n \int_{P_0}^{P_k} \bar\w \equiv \sum_{l = 1}^{\delta} \int_{P_0}^{P^{(l)}_{\infty}} \bar\w \mod \Lambda.
  \end{equation*}
  \end{rmk}
  
  
  
 \subsubsection{Non-coprime degrees}\label{subsec:ajm_inf_ncop}

  For $\delta > 1$ the problem becomes a lot harder. First we need a way to distinguish between the infinite points in $\mathcal{P}
  = \{ P_{\infty}^{(1)},\dots, P_{\infty}^{(\delta)} \}$ and second they are singular points
  on the projective closure of our affine model $\caff$
  whenever $m \ne \{n,n\pm1\}$.
  
  As shown in \cite[\S 1]{CT1996} we obtain a second affine patch of $\cu$ that is non-singular along $\mathcal{P}$
  in the following way:
  
  Denoting $M = \frac{m}\delta$ and $N = \frac{n}\delta$, we consider the birational transformation
  \begin{equation*}
   (x,y) = \Phi(r,t) = \left(\frac{1}{r^{\nu}t^M},\frac{r^{\mu}}{t^N}\right)
  \end{equation*}
  which results in an affine model
  \begin{equation*}
   \cafft : r^{\delta} = \prod_{k=1}^n (1-x_kr^{\nu}t^M).
  \end{equation*}
  The inverse transformation is given by
  \begin{equation*}
   (r,t) = \Phi^{-1}(x,y) = \left(\frac{y^M}{x^N},\frac{1}{x^{\mu}y^{\nu}}\right).
  \end{equation*}
  Under this transformation the infinite points in $\mathcal{P}$ are mapped to finite points that have the coordinates
  \begin{equation*}
   (r,t) = (\zeta_{\delta}^s,0) \quad s= 1,\dots,\delta
  \end{equation*}
  where $\zeta_{\delta} = e^{\frac{2\pi i }{\delta}}$. 
  Hence, we can describe the infinite points in $\mathcal{P} \subset \cu$ via
   \begin{equation*}
      P_{\infty}^{(s)} = \Phi^{-1}(\zeta_{\delta}^s,0).
   \end{equation*}
   
   
   Suppose we want to compute the Abel-Jacobi map of $D_{\infty}^{(s)} = P_{\infty}^{(s)} - P_0$ for $s \in \{1,\dots,\delta\}$.
   Again following our strategy,
   this time working on $\cafft$, we look at the intersection of the vertical line through $(\zeta_{\delta}^s,0)$ with
   $\cafft$
   \begin{equation*}
      E_1 = \div(r - \zeta_{\delta}^s) = \sum_{i = 1}^{d} \left(\zeta_{\delta}^s,t_i^{(s)}\right) - N E_1'
   \end{equation*}
      where the $t_i^{(s)}$ are the zeros of $g(t) = \prod_{k=1}^n (1-x_k\zeta_{\delta}^{s\nu}t^M) - 1 \in \C[t]$ and
    \begin{equation}\label{eq:zero_bp1}
       E_1' = \begin{cases}
	     (m-M) \Phi^{-1}(0,0), \quad \text{if} \; 0 \in X, \\
             \sum_{Q \in \pr^{-1}(0)} \Phi^{-1}Q \quad \text{otherwise}
            \end{cases}
    \end{equation}
    Note that $E_1$ satisfies $\supp(E_1) \cap \Phi(\mathcal{P}) = \{ (\zeta_{\delta}^s,0) \}$.
    Now, we can define the corresponding principal divisor on $\caff$ by
    \begin{equation*}
       D_1 := \div \left( \frac{y^M}{x^N} - \zeta_{\delta}^s \right);
    \end{equation*}
   then $\ord_{P_{\infty}^{(s)}}(D_1) \ge 1$ by construction.
    
  \begin{thm}\label{thm:ajm_inf_ord1}
    Assume $\ord_{P_{\infty}^{(s)}}(D_1) = 1$ and $0 \not\in X$. Then, for $s = 1,\dots,\delta$, there exist points $Q_1^{(s)},\dots,Q_{d-1}^{(s)} \in \cu \setminus \mathcal{P}$ such that
    \begin{equation}\label{eq:ajm_inf_ord1}
       \AJ( [D_{\infty}^{(s)}] ) \equiv -\sum_{i = 1}^{n-1} \int_{P_0}^{Q_i^{(s)}} \bar\w \mod \Lambda.
    \end{equation}
  \end{thm}
  \begin{proof}
    First note that $\ord_{P_{\infty}^{(s)}}(D_1) = 1$ implies $M = 1$, i.e. $m = \delta$. Together with the assumption
    $0 \not\in X$, this gives us $\deg(g) = n$.
    Moreover, we can assume that $t_n^{(s)} = 0$ and $t_i^{(s)} \ne 0$ for $i=1,\dots,n-1$.
    Therefore,
    \begin{align*}
      \AJ( [D_{\infty}^{(s)}] )  & \equiv  \AJ([D_{\infty}^{(s)} - D_1])  
      \equiv  -\AJ( [\sum_{i = 1}^{d-1} \Phi(\zeta_{\delta}^s,t_i^{(s)}) - N \sum_{Q \in \pr^{-1}(0)} Q  ] )
       \mod \Lambda.
    \end{align*}
    Since  $0 \not\in X$ (in fact this is true for any non-branch point) the sum over the integrals from $P_0$ to all $Q \in \pr^{-1}(0)$ vanishes modulo the period lattice. 
    Namely, for every $\wtij \in \W$ we have
    \begin{align*}
      & \sum_{Q \in \pr^{-1}(0)} \int_{P_0}^Q \wtij =  \sum_{l=0}^{m-1} \int_{P_0}^{(0,\zeta^l \sqrt[m]{f(0)})} \wtij \\
    & = m \int_{P_0}^{P_k} \wtij + \left(1 + \zeta^{-j} + \dots + \zeta^{-j(m-1)}\right) \int_{P_0}^{(0,\sqrt[m]{f(0)})} \wtij
    \end{align*}
    for some $k \in \{1,\dots,n\}$ and therefore
    \begin{equation*}
       \sum_{Q \in \pr^{-1}(0)} \int_{P_0}^Q \bar\w =  m \int_{P_0}^{P_k} \bar\w \overset{\eqref{m-eq:m_tors}}{\equiv} 0 \mod \Lambda.
    \end{equation*}
    If we take $Q_i^{(s)} = \Phi(\zeta_{\delta}^s,t_i^{(s)}) \in \cu \setminus \mathcal{P}$, $i = 1,\dots,d-1$, we are done:
    \begin{align*}
    -\AJ( [\sum_{i = 1}^{d-1} \Phi(\zeta_{\delta}^s,t_i^{(s)}) - N \sum_{Q \in \pr^{-1}(0)} Q ] ) \equiv 
    -\sum_{i = 1}^{n-1} \int_{P_0}^{Q_i^{(s)}} \bar\w \mod \Lambda.
    \end{align*}
     \end{proof}
    
    In the case of Theorem \ref{m-thm:ajm_inf_ord1} there exist additional relations between the vector integrals in 
    \eqref{m-eq:ajm_inf_ord1}, which we are going to establish now.
    Let $s \in \{1,\dots,\delta\}$, fix $i \in \{1,\dots,n-1\}$ and denote $Q^{(s)} = Q_i^{(s)}$ and $t^{(s)} = t_i^{(s)}$.
    On $\cafft$ we have the relation
     \begin{equation*}
	( \zeta_{\delta}^s,t^{(s)} ) = ( \zeta_{\delta}^s, \zeta_{\delta}^{-\nu s} t^{(\delta)} )
     \end{equation*}
     and therefore, if we write $(x^{(s)},y^{(s)}) :=  \Phi( \zeta^s,t^{(s)})$, then
     \begin{equation*}
      Q^{(s)} = (x^{(s)},y^{(s)}) = (x^{(\delta)},\zeta_{\delta}^{(\mu+\nu N)s} y^{(\delta)})).
     \end{equation*}
     The $Q^{(s)}$ having identical $x$-coordinates implies that there exists a $k \in \{1,\dots,n\}$ such that
     \begin{equation*}
      \int_{P_0}^{Q^{(s)}} \bar\w =  \int_{P_0}^{P_k} \bar\w  +  \int_{P_k}^{Q^{(s)}}  \bar\w,
     \end{equation*}
     while the relation between their $y$-coordinates yields
     \begin{equation*}
       \int_{P_k}^{Q^{(s)}} \wtij = \zeta_{\delta}^{-(\mu+\nu N)sj} \int_{P_k}^{Q^{(\delta)}} \wtij 
     \end{equation*}
     for all $\wtij \in \W$. This proves the following corollary:
     
    \begin{coro}\label{coro:ajm_inf_ord1}
    Under the assumptions of Theorem \ref{m-thm:ajm_inf_ord1} and with the above notation we can obtain the
    image of $D_{\infty}^{(s)}$ under the Abel-Jacobi map
    for all $s = 1,\dots,\delta$ from the $n-1$ vector integrals
    \begin{equation*}
     \int_{P_k}^{Q_i^{(\delta)}} \bar\w, \quad i = 1,\dots,n-1.
    \end{equation*}
    \end{coro}
   

    \bigskip
    
    Unfortunately, this is just a special case. If $\ord_{P_{\infty}^{(s)}}(D_1)$ is greater than $1$ (for instance, if $\delta \ne m$),
     the vertical line $r-\zeta_{\delta}^s$ is tangent to the curve $\cafft$ 
    at $(\zeta_{\delta}^s,0)$ and cannot be used for our purpose.
    
    Consequently, we must find another function. One possible choice here is the line $r - t -  \zeta_{\delta}^s$, which
    is now guaranteed to have a simple intersection with $\cafft$ 
    at $(\zeta_{\delta}^s,0)$ and does not intersect $\cafft$ in $(\zeta_{\delta}^{s'},0)$, $s \ne s'$.

    The corresponding principal divisor is given by
     \begin{equation*}
      E_2 = \div(r - t - \zeta_{\delta}^s) = \sum_{i = 1}^{d} (t_i^{(s)}+\zeta_{\delta}^s,t_i^{(s)}) - \nu \sum_{k=1}^n
      \Phi^{-1}(x_k,0)- N E_2'
   \end{equation*}
      where the $t_i^{(s)}$ are the zeros of $g(t) = \prod_{k=1}^n (1-x_k(t+\zeta_{\delta}^{(s)})^{\nu}t^M) - 1 \in \C[t]$, $d = \deg(g)$ and
    \begin{equation}\label{eq:zero_bp2}
       E_2' = \begin{cases}
	   (m-\frac{M+\nu}{N}) \Phi^{-1}(0,0), \quad \text{if} \; 0 \in X, \\
             \sum_{Q \in \pr^{-1}(0)} \Phi^{-1}Q, \quad \text{otherwise.}
             \end{cases}
    \end{equation}
    Now, 
    \begin{equation*}
     D_2 := \div \left( \frac{y^M}{x^N} - \frac{1}{x^{\mu}y^{\nu}} - \zeta_{\delta}^s \right)
    \end{equation*}
    is a principal divisor on $\caff$ such that
    $\ord_{P_{\infty}^{(s)}}(D_2) = 1$.
    
    \begin{thm}\label{thm:ajm_inf_ordgt1}
      Assume $\ord_{P_{\infty}^{(s)}}(D_1) > 1$ and $0 \not\in X$. Then, for $s = 1,\dots,\delta$, there exist points $Q_1^{(s)},\dots,Q_{d-1}^{(s)} \in \cu \setminus \mathcal{P}$ such that
    \begin{equation*}%\label{eq:ajm_int_ord0}
       \AJ( [D_{\infty}^{(s)}] ) \equiv -\sum_{i = 1}^{d-1} \int_{P_0}^{Q_i^{(s)}} \bar\w + \nu \sum_{k=1}^n
      \int_{P_0}^{P_k} \bar\w \mod \Lambda,
    \end{equation*}
    where $d = n(\nu+M)$.
    \end{thm}
   \begin{proof}
    First notice that $0 \not\in X$ implies $d = \deg(g) = n(\nu+M)$. Moreover, our assumption implies $\ord_{P_{\infty}^{(s)}}(D_2) = 1$ so that we may assume
    $t_d^{(s)} = 0$ and $t_i^{(s)} \ne 0$ for $i=1,\dots,d-1$. 	Then,
    \begin{align*}
     \AJ( [D_{\infty}^{(s)}] ) \equiv & \AJ([D_{\infty}^{(s)} - D_2]) \\
      \equiv & -\AJ( [\sum_{i = 1}^{d-1} \Phi(t_i^{(s)}+\zeta_{\delta}^s,t_i^{(s)}) - \nu \sum_{k=1}^n
      (x_k,0) - N \sum_{Q \in \pr^{-1}(0)} Q ] )
       \mod \Lambda.
    \end{align*}
   Choosing the points 
    $Q_i^{(s)} = \Phi(t_i^{(s)}+\zeta_{\delta}^s,t_i^{(s)}) \in \cu \setminus \mathcal{P}$ and
     using the same reasoning as in the proof of Theorem \ref{m-thm:ajm_inf_ord1} and 
    proves the statement.
     \end{proof}
    
    \begin{rmk}\label{rmk:zero_bp}
     We can easily modify the statements of the Theorems \ref{m-thm:ajm_inf_ord1} and \ref{thm:ajm_inf_ordgt1} to hold for
     $0 \in X$, i.e. when $0$ is a branch point. 
     Using equation \eqref{m-eq:zero_bp1}, the statement of Theorem \ref{m-thm:ajm_inf_ord1} becomes
      \begin{equation*}
       \AJ( [D_{\infty}^{(s)}] ) \equiv -\sum_{i = 1}^{n-1} \int_{P_0}^{Q_i^{(s)}} \bar\w + N(m-M) \int_{P_0}^{(0,0)} \bar\w \mod \Lambda,
    \end{equation*}
    whereas, using equation \eqref{m-eq:zero_bp2}, the statement of Theorem \ref{m-thm:ajm_inf_ordgt1} becomes
      \begin{equation*}
       \AJ( [D_{\infty}^{(s)}] ) \equiv -\sum_{i = 1}^{d-1} \int_{P_0}^{Q_i^{(s)}} \bar\w + \nu \sum_{k=1}^n
      \int_{P_0}^{P_k} \bar\w + (Nm-M-\nu) \int_{P_0}^{(0,0)} \bar\w \mod \Lambda,
    \end{equation*}
    with $d = n(\nu+M)$.
    \end{rmk}

  \subsection{Reduction modulo period lattice}\label{subsec:lat_red}

    In order for the Abel-Jacobi map to be well defined we have to reduce modulo the period lattice $\Lambda = 
  \Omega\Z^{2g}$, where $\Omega = (\OA, \OB)$ is the big period matrix, computed as explained in
  Section \ref{m-sec:strat_pm}.
   
   For reasons that will be addressed later in this paragraph
   we choose to
   represent the image of the Abel-Jacobi map in 
    $\R^{2g} / \Z^{2g}$.
    
   Let $v = \int_P^Q \bar\w \in \C^g$ be an vector obtained by integrating the holomorphic differentials in
   $\W$.
   We identify $\C^g$ and $\R^{2g}$ via the bijection
   \begin{equation*}
    \iota: v = (v_1,\dots,v_g)^T \mapsto (\Re(v_1),\dots,\Re(v_g),\Im(v_1),\dots,\Im(v_g))^T.
   \end{equation*}
    Applying $\iota$ to the columns of $\Omega$ yields the invertible real matrix
   \begin{equation*}
    \Omega_{\R} = 
   \begin{pmatrix}
     \Re(\OA) & \Re(\OB) \\
     \Im(\OA) & \Im(\OB)
    \end{pmatrix} \in \R^{2g \times 2g}.
   \end{equation*}
   Now, reduction of $v$ modulo $\Lambda$ corresponds bijectively to taking the fractional part of $\Omega_{\R}^{-1}\iota(v)$
   \begin{equation*}
    v \bmod \Lambda \leftrightarrow \lfloor \Omega_{\R}^{-1}\iota(v) \rceil.
   \end{equation*}
   This representation has the following advantages:
   \begin{rmk}[Image of Abel-Jacobi map] \
    \begin{itemize}
     \item[$\bullet$] Operations on the Jacobian variety $\Jac(\cu)$ correspond to operations in $\R^{2g}/\Z^{2g}$.
     \item[$\bullet$] $m$-torsion divisors under $\AJ$ are mapped to vectors of rational numbers with 
     denominator dividing $m$, i.e. for $k,j \in \{ 1,\dots,n \}$ we have
     \begin{equation*}
      \AJ([P_k - P_j]) \equiv \lfloor \Omega_{\R}^{-1} \iota \int_{P_j}^{P_k} \bar\w
      \rceil \in \frac{1}m\Z^{2g}.
     \end{equation*}
    \end{itemize}
   \end{rmk}

\biblio
\end{document}
